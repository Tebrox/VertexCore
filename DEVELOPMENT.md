# DEVELOPMENT â€“ Using VertexCore in Your Plugin

This guide explains how to integrate **VertexCore** into your own Paper/Bukkit plugin.
VertexCore provides reusable infrastructure for:

- **Config** (class-based YAML with comments, key paths, validation)
- **Database** (json/flatfile, H2, MySQL via HikariCP)
- **Registration** (auto database warmup + enables migration support)
- **Migration command** (`/vertexcore migrate ...`)

---

## 1) Requirements

- Java 21+
- Paper/Spigot compatible server
- **VertexCore** installed on the server

Your plugin must depend on VertexCore at runtime.

---

## 2) Declare the dependency

### plugin.yml

```yaml
depend:
  - VertexCore
```

---

## 3) Config usage (general configuration)

Config classes must implement `ConfigObject` and declare their file via `@StoreAt`.

### Example: config.yml

```java
@StoreAt("config.yml")
@ConfigComment({
        "ExamplePlugin configuration",
        "Generated by VertexCore. Unknown keys are preserved."
})
public final class PluginConfig implements ConfigObject {

    @ConfigComment({"Enable debug logging"})
    public boolean debug = false;

    @ConfigKey("cache.size")
    @ConfigComment({"Maximum size of the plugin cache"})
    @Min(1) @Max(10000)
    public int cacheSize = 100;

    @ConfigComment({"Language used for messages (e.g. en, de)"})
    public String language = "en";
}
```

Loading:

```java
PluginConfig config = new Config<>(this, PluginConfig.class).loadConfigObject();
```

---

## 4) Database configuration

Database settings must implement `DatabaseSettings`.

```java
@StoreAt("database.yml")
@ConfigComment({
        "Database configuration",
        "Backends: json | h2 | mysql",
        "H2 uses plugins/<PluginName>/database",
        "Unknown keys are preserved."
})
public final class MyDatabaseSettings implements ConfigObject, DatabaseSettings {

    @ConfigKey("database.backend")
    @AllowedValues({"json", "h2", "mysql"})
    public String backend = "h2";

    @ConfigKey("database.useQueue")
    public boolean useQueue = true;

    @ConfigKey("database.timeoutMillis")
    public long timeoutMillis = 5000;

    @ConfigKey("database.poolSize")
    public int poolSize = 5;

    @ConfigKey("database.tablePrefix")
    public String tablePrefix = "";

    @ConfigKey("database.mysql.url")
    public String mysqlUrl = "";

    @ConfigKey("database.mysql.user")
    public String mysqlUser = "";

    @ConfigKey("database.mysql.password")
    public String mysqlPassword = "";

    @Override public String backend() { return backend; }
    @Override public boolean useQueue() { return useQueue; }
    @Override public long timeoutMillis() { return timeoutMillis; }
    @Override public int poolSize() { return poolSize; }
    @Override public String tablePrefix() { return tablePrefix; }
    @Override public String mysqlUrl() { return mysqlUrl; }
    @Override public String mysqlUser() { return mysqlUser; }
    @Override public String mysqlPassword() { return mysqlPassword; }
}
```

---

## 5) Registration

Register your plugin once in `onEnable()`:

```java
VertexCoreApi.get().registry().register(
        this,
        () -> dbSettings,
        PlayerData.class
);
```

---

## 6) Database usage

```java
Database<PlayerData> db = new Database<>(this, settings, PlayerData.class);
```

Async load:

```java
db.loadObjectAsync(uuid).thenAccept(data -> {});
```

---

## 7) Migration command

```text
/vertexcore migrate <plugin> <from> <to> [flags]
```

Flags:
- `--dry-run`
- `--overwrite`
- `--delete-source` (requires `--confirm`)
